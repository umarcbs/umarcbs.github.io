<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Audio Visualizer">
        <title>Audio Player</title>
        <meta name="description" content="">  
    <meta name="author" content="">

   <!-- mobile specific metas
   ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <script type="text/javascript" src="jquery.minqrc.js"></script>
    <script type="text/javascript" src="qrcode.js"></script>
    <!-- CSS
   ================================================== -->
   <link rel="stylesheet" href="css/base.css">  
   <link rel="stylesheet" href="css/main.css">
   <link rel="stylesheet" href="css/vendor.css">     

   <!-- script
   ================================================== -->
    <script src="js/modernizr.js"></script>

   <!-- favicons
    ================================================== -->
    <link rel="icon" type="image/png" href="favicon.png">
<!--
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudfare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
-->
</head>

<body>

    <!-- header 
   ================================================== -->
   <header class="main-header">
    <div class="row">
        <div class="logo">
             <a href="index.html">cqrCyber</a>
          </div>        
    </div>   

    <a class="menu-toggle" href="#"><span>Menu</span></a>   
   </header> <!-- /header -->

   <!-- navigation 
   ================================================== -->
   <nav id="menu-nav-wrap">
<style type="text/css">
    low{
        text-transform: capitalize;
        font-family: cursive;
        color: darkorange;
        font-size: 18px;
    }
</style>
<style type="text/css">
    olow{
        text-transform: lowercase;
        font-family: arial;
        font-size: 18px;
    }
</style>
<style type="text/css">
    gr{
        color: green;
    }
</style>
    <h5 style="text-transform: capitalize; font-family: cursive;"><olow>cqr</olow><low>Cyber</low> <br>Audio Player <i class="fa fa-volume-up"></i></h5><hr/>  
    <p style="text-align: justify; line-height: 18px;">This simple tool will let you play and visualise audio from any file that contains audio (e.g., audio files [.mp3, .wav, etc] and video files [.3gp, .mp4, etc]). Simply select any file or drag and drop any file and it will start running and visualising it. In order to make it work smoothly select an audio file.
            <ul class="nav-list">
            
<hr/>
            <li><a href="demo1.html" title="About and Contact" style="font-size: 15px;"><i class="fa fa-info-circle" style="color: darkorange;"></i> Home</a></li>
            
            <li><a href="demo3.html" title="cqrCyber Projects" style="font-size: 15px;"><i class="fa fa-shield" style="font-size: 15px; color: darkorange;"></i> Projects</a></li>
            <li><a href="demo2.html" title="Others" style="font-size: 15px;"><i class="fa fa-tags" style="color: darkorange;"></i> Miscellaneous</a></li>
            <!--
             -->             
        </ul>

<!--
        
-->
        <hr/>
        <h5><olow>cqr</olow><low>Cyber</low><i class="fa fa-shield" style="font-size: 10px; color: green;"></i></h5>  
        <p style="text-align: justify; line-height: 18px;">Secure Cyber is a simple effort towards building projects related to Computer Science & Cyber Security.
           <br><cpy style="color: darkorange; font-size: 12px;"><cpy1 style="color: white;">Copyright &copy 2020</cpy1> cqrcyber.xyz  </cpy>
        </p>

        

    </nav>

    <!-- main content
   ================================================== -->
   <main id="main-404-content" class="main-content-static">

    <div class="content-wrap">

           <div class="shadow-overlay"></div>

           <div class="main-content">
            <div class="row">
                <div class="col-twelve">
                    
                        
                        <style type="text/css">
                            olo{
                                color: darkorange;
                            }
                        </style>
                        <style type="text/css">
                            oll{
                                color: white;
                            }
                        </style>
                        <style type="text/css">
                            lll{
                                color: green;
                            }
                        </style>
                        <p style="text-align: justify;"><br><br>
                        <oll>cqr</oll><olo>Cyber</olo><i class="fa fa-audio" style="font-size: 9px; color: green;"></i> <lll>Audio Player <i class="fa fa-volume-up"></i>
                        </p>
        <style type="text/css">
            html, body {
                margin: 0;
                font-family: arial, "Microsoft YaHei";
                background-color: #272822;
                color: #FEFEFE;
            }
            #fileWrapper{
                transition:all 0.5s ease;
            }
            #fileWrapper:hover{
                opacity: 1!important;
            }
            #visualizer_wrapper{
                text-align: left;
            }
            
        </style>
    </head>
    <body>
        <div id="wrapper">
            <div id="fileWrapper" class="file_wrapper">
                <div id="info" style="color: darkorange; font-family: cursive;">
                    
                </div>
                <label for="uploadedFile" style="color: white; font-family: arial;">Drag-&-Drop or Select a File to Play:</label>
                <input type="file" id="uploadedFile"></input>
            </div>
            <div id="visualizer_wrapper">
                <canvas id='canvas' width="350" height="270"></canvas>
            </div>
        </div>

        
        <script type="text/javascript">
            /*
             * An audio spectrum visualizer built with HTML5 Audio API
             * Author: Umar Farooq
             * License: MIT
             * FMay 12, 2020
             */
            window.onload = function() {
                new Visualizer().ini();
            };
            var Visualizer = function() {
                this.file = null, //the current file
                this.fileName = null, //the current file name
                this.audioContext = null,
                this.source = null, //the audio source
                this.info = document.getElementById('info').innerHTML, //this used to upgrade the UI information
                this.infoUpdateId = null, //to sotore the setTimeout ID and clear the interval
                this.animationId = null,
                this.status = 0, //flag for sound is playing 1 or stopped 0
                this.forceStop = false,
                this.allCapsReachBottom = false
            };
            Visualizer.prototype = {
                ini: function() {
                    this._prepareAPI();
                    this._addEventListner();
                },
                _prepareAPI: function() {
                    //fix browser vender for AudioContext and requestAnimationFrame
                    window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;
                    window.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame;
                    window.cancelAnimationFrame = window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame;
                    try {
                        this.audioContext = new AudioContext();
                    } catch (e) {
                        this._updateInfo('!Your browser does not support AudioContext', false);
                        console.log(e);
                    }
                },
                _addEventListner: function() {
                    var that = this,
                        audioInput = document.getElementById('uploadedFile'),
                        dropContainer = document.getElementsByTagName("canvas")[0];
                    //listen the file upload
                    audioInput.onchange = function() {
                        if (that.audioContext===null) {return;};

                        //the if statement fixes the file selction cancle, because the onchange will trigger even the file selection been canceled
                        if (audioInput.files.length !== 0) {
                            //only process the first file
                            that.file = audioInput.files[0];
                            that.fileName = that.file.name;
                            if (that.status === 1) {
                                //the sound is still playing but we upload another file, so set the forceStop flag to true
                                that.forceStop = true;
                            };
                            document.getElementById('fileWrapper').style.opacity = 1;
                            that._updateInfo('Uploading', true);
                            //once the file is ready,start the visualizer
                            that._start();
                        };
                    };
                    //listen the drag & drop
                    dropContainer.addEventListener("dragenter", function() {
                        document.getElementById('fileWrapper').style.opacity = 1;
                        that._updateInfo('Drop it on the page', true);
                    }, false);
                    dropContainer.addEventListener("dragover", function(e) {
                        e.stopPropagation();
                        e.preventDefault();
                        //set the drop mode
                        e.dataTransfer.dropEffect = 'copy';
                    }, false);
                    dropContainer.addEventListener("dragleave", function() {
                        document.getElementById('fileWrapper').style.opacity = 0.2;
                        that._updateInfo(that.info, false);
                    }, false);
                    dropContainer.addEventListener("drop", function(e) {
                        e.stopPropagation();
                        e.preventDefault();
                        if (that.audioContext===null) {return;};
                        document.getElementById('fileWrapper').style.opacity = 1;
                        that._updateInfo('Uploading', true);
                        //get the dropped file
                        that.file = e.dataTransfer.files[0];
                        if (that.status === 1) {
                            document.getElementById('fileWrapper').style.opacity = 1;
                            that.forceStop = true;
                        };
                        that.fileName = that.file.name;
                        //once the file is ready,start the visualizer
                        that._start();
                    }, false);
                },
                _start: function() {
                    //read and decode the file into audio array buffer
                    var that = this,
                        file = this.file,
                        fr = new FileReader();
                    fr.onload = function(e) {
                        var fileResult = e.target.result;
                        var audioContext = that.audioContext;
                        if (audioContext === null) {
                            return;
                        };
                        that._updateInfo('Decoding the audio', true);
                        audioContext.decodeAudioData(fileResult, function(buffer) {
                            that._updateInfo('Decoded succussfully,start the visualizer', true);
                            that._visualize(audioContext, buffer);
                        }, function(e) {
                            that._updateInfo('Failed to decode the file', false);
                            console.log(e);
                        });
                    };
                    fr.onerror = function(e) {
                        that._updateInfo('!Failed to read the file', false);
                        console.log(e);
                    };
                    //assign the file to the reader
                    this._updateInfo('Started reading the file', true);
                    fr.readAsArrayBuffer(file);
                },
                _visualize: function(audioContext, buffer) {
                    var audioBufferSouceNode = audioContext.createBufferSource(),
                        analyser = audioContext.createAnalyser(),
                        that = this;
                    //connect the source to the analyser
                    audioBufferSouceNode.connect(analyser);
                    //connect the analyser to the destination(the speaker), or we won't hear the sound
                    analyser.connect(audioContext.destination);
                    //then assign the buffer to the buffer source node
                    audioBufferSouceNode.buffer = buffer;
                    //play the source
                    if (!audioBufferSouceNode.start) {
                        audioBufferSouceNode.start = audioBufferSouceNode.noteOn //in old browsers use noteOn method
                        audioBufferSouceNode.stop = audioBufferSouceNode.noteOff //in old browsers use noteOn method
                    };
                    //stop the previous sound if any
                    if (this.animationId !== null) {
                        cancelAnimationFrame(this.animationId);
                    }
                    if (this.source !== null) {
                        this.source.stop(0);
                    }
                    audioBufferSouceNode.start(0);
                    this.status = 1;
                    this.source = audioBufferSouceNode;
                    audioBufferSouceNode.onended = function() {
                        that._audioEnd(that);
                    };
                    this._updateInfo('Playing: ' + this.fileName, false);
                    this.info = 'Playing: ' + this.fileName;
                    document.getElementById('fileWrapper').style.opacity = 0.2;
                    this._drawSpectrum(analyser);
                },
                _drawSpectrum: function(analyser) {
                    var that = this,
                        canvas = document.getElementById('canvas'),
                        cwidth = canvas.width,
                        cheight = canvas.height - 2,
                        meterWidth = 10, //width of the meters in the spectrum
                        gap = 3, //gap between meters
                        capHeight = 2,
                        capStyle = 'red',
                        meterNum = 100 , //count of the meters
                        capYPositionArray = []; ////store the vertical position of hte caps for the preivous frame
                    ctx = canvas.getContext('2d'),
                    gradient = ctx.createLinearGradient(0, 0, 0, 300);
                    gradient.addColorStop(1, 'darkorange');
                    gradient.addColorStop(0.5, 'green');
                    gradient.addColorStop(0, 'darkorange');
                    var drawMeter = function() {
                        var array = new Uint8Array(analyser.frequencyBinCount);
                        analyser.getByteFrequencyData(array);
                        if (that.status === 0) {
                            //fix when some sounds end the value still not back to zero
                            for (var i = array.length - 1; i >= 0; i--) {
                                array[i] = 0;
                            };
                            allCapsReachBottom = true;
                            for (var i = capYPositionArray.length - 1; i >= 0; i--) {
                                allCapsReachBottom = allCapsReachBottom && (capYPositionArray[i] === 0);
                            };
                            if (allCapsReachBottom) {
                                cancelAnimationFrame(that.animationId); //since the sound is top and animation finished, stop the requestAnimation to prevent potential memory leak,THIS IS VERY IMPORTANT!
                                return;
                            };
                        };
                        var step = Math.round(array.length / meterNum); //sample limited data from the total array
                        ctx.clearRect(0, 0, cwidth, cheight);
                        for (var i = 0; i < meterNum; i++) {
                            var value = array[i * step];
                            if (capYPositionArray.length < Math.round(meterNum)) {
                                capYPositionArray.push(value);
                            };
                            ctx.fillStyle = capStyle;
                            //draw the cap, with transition effect
                            if (value < capYPositionArray[i]) {
                                ctx.fillRect(i * 12, cheight - (--capYPositionArray[i]), meterWidth, capHeight);
                            } else {
                                ctx.fillRect(i * 12, cheight - value, meterWidth, capHeight);
                                capYPositionArray[i] = value;
                            };
                            ctx.fillStyle = gradient; //set the filllStyle to gradient for a better look
                            ctx.fillRect(i * 12 /*meterWidth+gap*/ , cheight - value + capHeight, meterWidth, cheight); //the meter
                        }
                        that.animationId = requestAnimationFrame(drawMeter);
                    }
                    this.animationId = requestAnimationFrame(drawMeter);
                },
                _audioEnd: function(instance) {
                    if (this.forceStop) {
                        this.forceStop = false;
                        this.status = 1;
                        return;
                    };
                    this.status = 0;
                    var text = 'An Audio Player & Viusalizer by cqrCyber';
                    document.getElementById('fileWrapper').style.opacity = 1;
                    document.getElementById('info').innerHTML = text;
                    instance.info = text;
                    document.getElementById('uploadedFile').value = '';
                },
                _updateInfo: function(text, processing) {
                    var infoBar = document.getElementById('info'),
                        dots = '...',
                        i = 0,
                        that = this;
                    infoBar.innerHTML = text + dots.substring(0, i++);
                    if (this.infoUpdateId !== null) {
                        clearTimeout(this.infoUpdateId);
                    };
                    if (processing) {
                        //animate dots at the end of the info text
                        var animateDot = function() {
                            if (i > 3) {
                                i = 0
                            };
                            infoBar.innerHTML = text + dots.substring(0, i++);
                            that.infoUpdateId = setTimeout(animateDot, 250);
                        }
                        this.infoUpdateId = setTimeout(animateDot, 250);
                    };
                }
            }
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-46794744-3', 'duapp.com');
            ga('send', 'pageview');
        </script>


        </div> <!-- /twelve -->                     
            </div> <!-- /row -->                    
           </div> <!-- /main-content --> 

           <footer>
            <div class="row">

                <div class="col-seven tab-full social-links pull-right">
                    <!--<ul>
                        <li><a href="#" title="@umarcbs"><i class="fa fa-github"></i></a></li>
                          <li><a href="#" title="@umarcbs"><i class="fa fa-twitter"></i></a></li>
                          <li><a href="https://api.whatsapp.com/send?phone=916005728432" title="+916005728432"><i class="fa fa-whatsapp"></i></a></li>
                          <li><a href="#" title="+916005728432"><i class="fa fa-phone"></i></a></li>
                          <li><a href="mailto:soulatf3@gmail.com" title="soulatf3@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
                          <li><a href="#" title="www.soulat.in"><i class="fa fa-globe"></i></a></li>            
                    </ul>-->
                </div>
                    
                    <div class="col-five tab-full bottom-links">
                    <!--<ul class="links"><br><br><br>
                        <li><a href="#" title="Home">Homepage</a></li>
                         <li><a href="#" title="Others">Miscellaneous</a></li>
                         <li><a href="#" title="cqrCyber Projects">Projects</a></li>
                                                    
                    </ul>-->

                    <div class="credits"><br><br><br>
                        <p style="color: silver; font-size: 13px;">Designed and Coded by <a  href="http://soulat.in" title="Umar Farooq">Umar Farooq</a>
                            | <cpy1 style="color: white;">Copyright &copy 2020 | </cpy1> <cpy><cpy2 style="color: white;">cqr</cpy2><cpy3 style="color: darkorange;">Cyber</cpy3>.xyz  </cpy></p>
                    </div>
                </div>                  
</div>
            </div> <!-- /row -->                    
           </footer>

        </div> <!-- /content-wrap -->
   
   </main> <!-- /main-404-content -->

   <div id="preloader"> 
        <div id="loader"></div>
   </div> 

   <!-- Java Script
   ================================================== --> 
   <script src="js/jquery-2.1.3.min.js"></script>
   <script src="js/plugins.js"></script>
   <script src="js/main.js"></script>

    </body>
</html>